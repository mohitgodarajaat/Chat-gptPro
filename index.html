<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAT-GPT PRO — Elite</title>
    
    <link rel="icon" type="image/png" href="https://img.icons8.com/fluency/48/artificial-intelligence.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { height: 100dvh; overflow: hidden; font-family: 'Plus Jakarta Sans', sans-serif; background: #09090b; color: #fafafa; }
        .sidebar { background: #0c0c0e; border-right: 1px solid #1f1f22; z-index: 50; }
        .glass-card { background: linear-gradient(135deg, rgba(16, 163, 127, 0.1) 0%, rgba(16, 163, 127, 0) 100%); border: 1px solid rgba(16, 163, 127, 0.3); border-radius: 16px; position: relative; overflow: hidden; }
        .msg-user { background: #10a37f; color: white; border-radius: 20px 20px 4px 20px; padding: 14px 18px; align-self: flex-end; max-width: 85%; margin-left: auto; box-shadow: 0 4px 15px rgba(16, 163, 127, 0.2); }
        .msg-ai { background: #18181b; border: 1px solid #27272a; border-radius: 20px 20px 20px 4px; padding: 14px 18px; align-self: flex-start; max-width: 85%; }
        #chat-scroller::-webkit-scrollbar { width: 5px; }
        #chat-scroller::-webkit-scrollbar-thumb { background: #27272a; border-radius: 10px; }
        .history-item { transition: 0.2s; cursor: pointer; border-radius: 8px; margin-bottom: 5px; padding: 8px; font-size: 13px; color: #a1a1aa; display: flex; justify-content: space-between; align-items: center; }
        .active-chat { background: #10a37f22; color: #10a37f; border: 1px solid #10a37f44; }
        .ai-logo-box { width: 40px; height: 40px; border-radius: 10px; overflow: hidden; box-shadow: 0 0 15px rgba(16, 163, 127, 0.4); border: 1px solid rgba(16, 163, 127, 0.5); }
        .typing-dots { display: flex; gap: 4px; padding: 10px; }
        .dot { width: 6px; height: 6px; background: #10a37f; border-radius: 50%; animation: bounce 1.4s infinite; }
        @keyframes bounce { 0%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-6px); } }
        /* Modal Style */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
    </style>
</head>
<body class="dark overflow-hidden flex h-full">

    <div id="settingModal" class="modal">
        <div class="bg-[#131316] border border-zinc-800 p-6 rounded-3xl w-80 shadow-2xl">
            <h2 class="text-lg font-bold mb-4">API Settings</h2>
            <p class="text-xs text-zinc-500 mb-2">Update your GitHub Token</p>
            <input type="password" id="customToken" class="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-3 text-sm text-white outline-none focus:border-[#10a37f]" placeholder="Enter new token...">
            <div class="flex gap-2 mt-6">
                <button onclick="saveToken()" class="flex-1 py-3 bg-[#10a37f] text-white rounded-xl font-bold text-sm">Save</button>
                <button onclick="closeModal()" class="flex-1 py-3 bg-zinc-800 text-white rounded-xl font-bold text-sm">Cancel</button>
            </div>
        </div>
    </div>

    <aside id="sidebar" class="sidebar fixed inset-y-0 left-0 w-72 md:relative md:translate-x-0 -translate-x-full flex flex-col transition-transform duration-300">
        <div class="p-6 flex-1 flex flex-col overflow-hidden">
            <div class="flex items-center gap-3 mb-10">
                <div class="ai-logo-box">
                    <img src="https://cdn-icons-png.flaticon.com/512/2103/2103633.png" alt="AI Logo" class="w-full h-full object-cover p-1">
                </div>
                <span class="font-bold text-xl tracking-tight">GPT-PRO <span class="text-[10px] bg-zinc-800 px-2 py-0.5 rounded text-zinc-400">v3.0</span></span>
            </div>

            <button onclick="startNewSession()" class="w-full py-3.5 bg-white text-black rounded-2xl font-bold mb-8 active:scale-95">+ New Session</button>
            
            <p class="text-[10px] font-bold text-zinc-600 uppercase tracking-[0.2em] px-2 mb-4">Chat History</p>
            <div id="history-container" class="flex-1 overflow-y-auto pr-2"></div>

            <div class="mt-4 pt-4 border-t border-zinc-800 space-y-2">
                <button onclick="openModal()" class="w-full p-3 glass-card flex items-center gap-3 text-sm text-zinc-300 hover:text-white transition-all">
                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    Settings
                </button>
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col relative w-full overflow-hidden">
        <header class="md:hidden flex items-center p-4 border-b border-zinc-800 bg-[#0c0c0e]">
            <button onclick="document.getElementById('sidebar').classList.toggle('-translate-x-full')" class="p-2 text-white">☰</button>
            <span class="ml-4 font-bold text-[#10a37f]">GPT-PRO</span>
        </header>

        <div id="chat-scroller" class="flex-1 overflow-y-auto p-4 md:p-12 flex flex-col gap-8">
            <div id="welcome" class="my-auto text-center">
                <h1 class="text-4xl font-bold mb-4 tracking-tighter">What can I <span class="text-[#10a37f]">create</span> today?</h1>
            </div>
        </div>

        <div class="p-4 md:pb-12 md:px-12 bg-gradient-to-t from-[#09090b] to-transparent">
            <div id="preview-area" class="max-w-4xl mx-auto mb-2 flex gap-2"></div>
            <div class="max-w-4xl mx-auto bg-[#131316] border border-zinc-800 rounded-[24px] p-2 flex items-end gap-2 focus-within:border-[#10a37f]/40 transition-all">
                <input type="file" id="fileIn" class="hidden" multiple accept="image/*,.pdf" onchange="handleFiles(event)">
                <button onclick="document.getElementById('fileIn').click()" class="p-3 text-zinc-500 hover:text-white transition-colors">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2.001 2.001 0 11-2.83-2.83l8.49-8.48"/></svg>
                </button>
                <textarea id="chatInput" rows="1" class="flex-1 bg-transparent border-none outline-none text-white p-3 resize-none max-h-40" placeholder="Type or upload..." onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();send();}"></textarea>
                <button onclick="send()" class="p-3.5 bg-[#10a37f] text-white rounded-[18px] hover:bg-[#0d8a6a] transition-all">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
                </button>
            </div>
        </div>
    </main>

    <script>
        // HIDDEN TOKEN (Default)
        const _d = ["github_pat_11BT7VRMI0LBWJ", "xUbOGGzx_j7QPRAjmoOcAYj0VlgL", "Nffw6V1g9cKrNe4LWRdda7jBYOLNPXXVHxVdlgP1"].join('');
        
        let currentChatId = null;
        let allChats = JSON.parse(localStorage.getItem('elite_history_v1') || '{}');
        let attachedFiles = [];

        function getActiveToken() {
            return localStorage.getItem('user_custom_token') || _d;
        }

        function openModal() { document.getElementById('settingModal').style.display = 'flex'; }
        function closeModal() { document.getElementById('settingModal').style.display = 'none'; }
        function saveToken() {
            const tk = document.getElementById('customToken').value.trim();
            if(tk) { localStorage.setItem('user_custom_token', tk); alert("Token Updated!"); }
            closeModal();
        }

        function renderHistory() {
            const container = document.getElementById('history-container');
            container.innerHTML = '';
            Object.keys(allChats).reverse().forEach(id => {
                const item = document.createElement('div');
                item.className = `history-item ${id === currentChatId ? 'active-chat' : ''}`;
                item.innerHTML = `<span onclick="loadChat('${id}')" class="truncate flex-1">${allChats[id].msgs[0]?.content.substring(0, 15) || "New Chat"}</span><button onclick="deleteChat('${id}')">×</button>`;
                container.appendChild(item);
            });
        }

        function loadChat(id) {
            currentChatId = id;
            const scroller = document.getElementById('chat-scroller');
            scroller.innerHTML = '';
            document.getElementById('welcome')?.remove();
            allChats[id].msgs.forEach(m => appendMsg(m.role, m.content));
            if(window.innerWidth < 768) document.getElementById('sidebar').classList.add('-translate-x-full');
            renderHistory();
        }

        function deleteChat(id) {
            if(confirm("Delete?")) { delete allChats[id]; if(currentChatId === id) currentChatId = null; localStorage.setItem('elite_history_v1', JSON.stringify(allChats)); renderHistory(); }
        }

        function startNewSession() { currentChatId = 'chat_'+Date.now(); allChats[currentChatId] = {msgs:[]}; location.reload(); }

        async function handleFiles(e) {
            const preview = document.getElementById('preview-area');
            for (let f of e.target.files) {
                const reader = new FileReader();
                reader.onload = (ev) => {
                    attachedFiles.push({ type: f.type.startsWith('image/') ? 'img' : 'pdf', data: ev.target.result });
                    const div = document.createElement('div');
                    div.className = "w-12 h-12 rounded-lg bg-zinc-800 border overflow-hidden";
                    div.innerHTML = f.type.startsWith('image/') ? `<img src="${ev.target.result}" class="w-full h-full object-cover">` : `<div class="p-1 text-[8px]">PDF</div>`;
                    preview.appendChild(div);
                };
                reader.readAsDataURL(f);
            }
        }

        async function send() {
            const input = document.getElementById('chatInput');
            const txt = input.value.trim();
            if (!txt && !attachedFiles.length) return;
            if (!currentChatId) { currentChatId = 'chat_'+Date.now(); allChats[currentChatId] = {msgs:[]}; }

            document.getElementById('welcome')?.remove();
            document.getElementById('preview-area').innerHTML = '';
            
            const userContent = txt + (attachedFiles.length ? ` [File Attached]` : '');
            appendMsg('user', userContent);
            
            let payload = [{ type: "text", text: txt || "Analyze files" }];
            attachedFiles.forEach(f => { if(f.type==='img') payload.push({type:"image_url", image_url:{url:f.data}}); });
            
            allChats[currentChatId].msgs.push({role: 'user', content: userContent, raw: payload});
            attachedFiles = [];
            input.value = '';

            const aiDiv = appendMsg('assistant', '<div class="typing-dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>');
            
            try {
                const r = await fetch("https://models.inference.ai.azure.com/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${getActiveToken()}`, "Content-Type": "application/json" },
                    body: JSON.stringify({ model: "gpt-4o", messages: allChats[currentChatId].msgs.map(m => ({role: m.role, content: m.raw || m.content})) })
                });
                const d = await r.json();
                const reply = d.choices[0].message.content;
                aiDiv.innerHTML = marked.parse(reply);
                allChats[currentChatId].msgs.push({role: 'assistant', content: reply});
                localStorage.setItem('elite_history_v1', JSON.stringify(allChats));
                renderHistory();
            } catch (e) { aiDiv.innerText = "Error. Check Token."; }
        }

        function appendMsg(role, content) {
            const s = document.getElementById('chat-scroller');
            const d = document.createElement('div');
            d.className = role === 'user' ? 'msg-user' : 'msg-ai prose prose-invert';
            d.innerHTML = (role === 'assistant' && !content.includes('dots')) ? marked.parse(content) : content;
            s.appendChild(d);
            s.scrollTop = s.scrollHeight;
            return d;
        }

        window.onload = renderHistory;
    </script>
</body>
</html>
